# docker-commands

### show commands & management commands
    $ docker
    
### Docker version info
    $ docker version
    
### Show info like number of containers, images, etc
    $ docker info

## Docker Image

**Docker Images are templates used to create Docker containers**

### Show commands
    $ docker images --help

### List all images on the system
    $ docker images

### Download the latest version of image
    $ docker pull <image_name>

### Download the specific version of image
    $ docker pull <image_name:tag>

### Show numeric IDs of image
    $ docker images -q

### Show dangling images
    $ docker images -f "dangling=true"

### Show detailed information about the image like created dates
    $ docker inspect <image_name>

### Remove an image
    $ docker rmi <image_name>

### Remove an image when it is being used by containers
    $ docker rmi -f <image_name>

## Docker Container

**Docker container is a running instance of image**

### Show running containers
    $ docker ps

### Show all containers
    $ docker ps -a

### Create and run a container in foreground
    $ docker run --name <container_name> <image_name>

Note: Change the default command by adding command at the end, e.g. `docker run Ubuntu echo "hello world!"`,
and "hello world" will be displayed on the screen immediately

### Create and run a container in background
    $ docker run -d --name <container_name> <image_name>
    # Use -p option to publish the port to the host machine
    $ docker run -d -p 80:80 --name nginx-server nginx

Note: Use `docker logs ContainerName/ID` to see the output

### Create and run a container in interactive mode
    $ docker run -it --name <container_name> <image_name>

### Start/stop a container
    $ docker start/stop <container_name/ID>

### Pause/resume a container
    $ docker pause/unpause <container_name/ID>

### Display the running processes of a container
    $ docker top <container_name/ID>

### Show a live stream of container(s) resource usage statistics
    $ docker stats <container_name/ID>

### Show detailed information about the container like created dates
    $ docker inspect <container_name/ID>

### Attach to a running container
    $ docker attach <container_name/ID>

### Launch a Bash terminal within a container
    $ docker exec -it <container_name/ID> /bin/bash
    # Use this if bash is part of your path
    $ docker exec -it <container_name/ID> bash

Note: Unlike attach, hitting `Ctrl-c` will only terminate the exec's command when running interactively

### Kill a running container
    $ docker kill <container_name/ID>
Note: `docker kill` command stops the main process of a container abruptly while `docker stop`
attempts to stop the container gracefully allowing the main process to clean up before shutting down

### Remove a container
    $ docker rm <container_name/ID>
### Remove all containers
    $ docker rm $(docker ps -aq)

## Docker Volume

**Volumes are the preferred mechanism for persisting data generated by and used by Docker containers**

### Show commands
    $ docker volume
    # or
    $ docker volume --help

### Create a volume
    $ docker volume create (<volume_name>)

### List volumes
    $ docker volume ls

### Display detailed information on one or more volumes
    $ docker volume inspect <volume_name>

### Remove all unused local volumes
    $ docker volume prune

### Remove one or more volumes 
    $ docker volume rm <volume_name>

### Mount a data volume
    $ docker run --mount source=<volume_name>, target=<path_in_container> <image_name>

Note: If you start a container with a volume that does not yet exist, Docker creates the volume for you

### Share data between containers
    $ docker run -it --name mytest1 --mount source=myvolume,target=/data ubuntu
    $ docker run -it --name mytest2 --mount source=myvolume,target=/data ubuntu
    # or using -v option
    $ docker run -it --name mytest1 -v myvolume:/data ubuntu
    $ docker run -it --name mytest2 -v myvolume:/data ubuntu

### Mount directory as a volume
    $ docker run -v <directory_name>:<volume_name> <image_name>
    # e.g.
    $ docker run -it --name=mytest3 -v /Data:/Data ubuntu

## Dockerfile

**Dockerfile is a text file with instructions to build image**

1. Create a file named Dockerfile

2. Add keywords and commands to Dockerfile

3. Build the image using 'docker build command' 
   ```
   $ docker build -t <iamge_name:tag> .
   ```
   
   `-t` option is used to set tag name of docker image


4. Verify the new Docker image and launch a container

    1. Use `docker images` to check whether new docker image is available in local image repository
    2. Launch a container 

## Shortcuts

### Kill a container within the session
    Ctrl-c

### Detach from a container without killing it
    Ctrl-p
    Ctrl-q
